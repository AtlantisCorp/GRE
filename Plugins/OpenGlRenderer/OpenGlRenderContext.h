//
//  OpenGlRenderContext.h
//  GRE
//
//  Created by Jacques Tronconi on 01/03/2016.
//
//

#ifndef GRE_OpenGlRenderContext_h
#define GRE_OpenGlRenderContext_h

#include "OpenGlIncludes.h"
#include "RenderContext.h"

class OpenGlRenderContext : public RenderContextPrivate
{
public:
    
    POOLED(Pools::Resource)
    
    OpenGlRenderContext(const std::string& name, const RenderContextInfo& ctxtInfo, Renderer parent = Renderer::Null);
    ~OpenGlRenderContext();
    
    //////////////////////////////////////////////////////////////////////
    /// @brief Bind the RenderContext.
    //////////////////////////////////////////////////////////////////////
    void bind();
    
    //////////////////////////////////////////////////////////////////////
    /// @brief Unbind this Object (make it unusable).
    //////////////////////////////////////////////////////////////////////
    void unbind();
    
    //////////////////////////////////////////////////////////////////////
    /// @brief Send every operations remaining to Hardware, and generally
    /// swap buffers.
    //////////////////////////////////////////////////////////////////////
    void flush();
    
    //////////////////////////////////////////////////////////////////////
    /// @brief Returns the Gl Object.
    //////////////////////////////////////////////////////////////////////
    Gl& getGl();
    
    //////////////////////////////////////////////////////////////////////
    /// @brief Returns the id of this Context.
    //////////////////////////////////////////////////////////////////////
    const uintptr_t& getId() const;
    
    //////////////////////////////////////////////////////////////////////
    /// @brief Returns expected data for user.
    //////////////////////////////////////////////////////////////////////
    const void* getCustomData(const std::string& dataname) const;
    
private:
    
#ifdef GrePlatformDarwin
    
    CGLContextObj _mContext;
    bool _mIsCreated;
    
#endif
    
    /// @brief Holds informations about the current Context Loaded.
    Gl _mGl;
    
    /// @brief Context Id (its own adress).
    uintptr_t _mCtxtId;
};

#endif
